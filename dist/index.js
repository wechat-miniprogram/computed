"use strict";var M=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var $=M(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(B,{getDataOnPath:function(){return st},parseMultiDataPaths:function(){return ut}});var V=/^\s/,g=function(t,e){throw Error('Parsing data path "'+t+'" failed at char "'+t[e]+'" (index '+e+")")},at=function(t,e){for(var n=e.index;e.index<e.length;){var r=t[e.index];if(/^[0-9]/.test(r)){e.index++;continue}break}return n===e.index&&g(t,e.index),parseInt(t.slice(n,e.index),10)},N=function(t,e){var n=e.index,r=t[n];if(/^[_a-zA-Z$]/.test(r))for(e.index++;e.index<e.length;){var c=t[e.index];if(/^[_a-zA-Z0-9$]/.test(c)){e.index++;continue}break}else g(t,e.index);return t.slice(n,e.index)},F=function(t,e){for(var n=[N(t,e)],r={deepCmp:!1};e.index<e.length;){var c=t[e.index];if(c==="[")e.index++,n.push(""+at(t,e)),t[e.index]!=="]"&&g(t,e.index),e.index++;else if(c==="."){if(e.index++,t[e.index]==="*"){if(e.index++,t[e.index]==="*"){e.index++,r.deepCmp=!0;break}g(t,e.index)}n.push(N(t,e))}else break}return{path:n,options:r}},it=function(t,e){for(;V.test(t[e.index]);)e.index++;for(var n=[F(t,e)],r=!1;e.index<e.length;){var c=t[e.index];V.test(c)?e.index++:c===","?(r=!0,e.index++):r?(r=!1,n.push(F(t,e))):g(t,e.index)}return n},ct=function(t,e){e.index<e.length&&g(t,e.index)},ut=function(t){var e={length:t.length,index:0},n=it(t,e);return ct(t,e),n},st=function(t,e){var n=t;return e.forEach(function(r){var c;n=(n===void 0?"undefined":(c=n)&&typeof Symbol<"u"&&c.constructor===Symbol?"symbol":typeof c)!="object"||n===null?void 0:n[r]}),n}});var z=M((Dt,U)=>{U.exports=function(){let e=null,n;function r(i){return i?typeof i=="object"||typeof i=="function":!1}function c(i){if(i!==null&&!r(i))throw new TypeError("Object prototype may only be an Object or null: "+i)}let o=Object,a=!!o.create||!({__proto__:null}instanceof o),u=o.create||(a?function(s){return c(s),{__proto__:s}}:function(s){if(c(s),s===null)throw new SyntaxError("Native Object.create is required to create objects with null prototype");var v=function(){};return v.prototype=s,new v}),p=function(){return null},_=o.getPrototypeOf||([].__proto__===Array.prototype?function(s){let v=s.__proto__;return r(v)?v:null}:p);return n=function(i,s){if((this&&this instanceof n?this.constructor:void 0)===void 0)throw new TypeError("Constructor Proxy requires 'new'");if(!r(i)||!r(s))throw new TypeError("Cannot create proxy with a non-object as target or handler");let h=function(){};e=function(){i=null,h=function(f){throw new TypeError(`Cannot perform '${f}' on a proxy that has been revoked`)}},setTimeout(function(){e=null},0);let l=s;s={get:null,set:null,apply:null,construct:null};for(let f in l){if(!(f in s))throw new TypeError(`Proxy polyfill does not support trap '${f}'`);s[f]=l[f]}typeof l=="function"&&(s.apply=l.apply.bind(l));let b=_(i),d,j=!1,D=!1;typeof i=="function"?(d=function(){let y=this&&this.constructor===d,m=Array.prototype.slice.call(arguments);if(h(y?"construct":"apply"),y&&s.construct)return s.construct.call(this,i,m);if(!y&&s.apply)return s.apply(i,this,m);if(y){m.unshift(i);let P=i.bind.apply(i,m);return new P}return i.apply(this,m)},j=!0):i instanceof Array?(d=[],D=!0):d=a||b!==null?u(b):{};let W=s.get?function(f){return h("get"),s.get(this,f,d)}:function(f){return h("get"),this[f]},I=s.set?function(f,y){h("set");let m=s.set(this,f,y,d)}:function(f,y){h("set"),this[f]=y},x=o.getOwnPropertyNames(i),T={};x.forEach(function(f){if((j||D)&&f in d)return;let m={enumerable:!!o.getOwnPropertyDescriptor(i,f).enumerable,get:W.bind(i,f),set:I.bind(i,f)};o.defineProperty(d,f,m),T[f]=!0});let A=!0;if(j||D){let f=o.setPrototypeOf||([].__proto__===Array.prototype?function(m,P){return c(P),m.__proto__=P,m}:p);b&&f(d,b)||(A=!1)}if(s.get||!A)for(let f in i)T[f]||o.defineProperty(d,f,{get:W.bind(i,f)});return o.seal(i),o.seal(d),d},n.revocable=function(i,s){return{proxy:new n(i,s),revoke:e}},n}});var K=M(H=>{"use strict";function C(t){return t&&typeof Symbol<"u"&&t.constructor===Symbol?"symbol":typeof t}Object.defineProperty(H,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(H,{create:function(){return pt},unwrap:function(){return function t(e){if(e!==null&&(e===void 0?"undefined":C(e))==="object"&&C(e.__rawObject__)!=="object"){if(Array.isArray(e))return e.map(function(r){return t(r)});var n={};return Object.keys(e).forEach(function(r){n[r]=t(e[r])}),n}return(e===void 0?"undefined":C(e))!=="object"||e===null||C(e.__rawObject__)!=="object"?e:e.__rawObject__}}});var L,ft=(0,((L=z())&&L.__esModule?L:{default:L}).default)(),Z=function(t,e,n){if((t===void 0?"undefined":C(t))!=="object"||t===null)return t;var r={get:function(c,o){if(o==="__rawObject__")return c;var a=null,u=n.concat(o),p=c[o];return e.push({kind:"value",path:u,value:p}),Z(p,e,u)},ownKeys:function(c){var o=n.slice(),a=Object.keys(c).sort();return e.push({kind:"keys",path:o,keys:a}),a}};try{return new Proxy(t,r)}catch{return new ft(t,r)}};function pt(t,e){return Z(t,e,[])}});var nt=M(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(q,{behavior:function(){return yt},computed:function(){return bt},generateWatches:function(){return et},watch:function(){return mt}});var w,ht=Q(require("rfdc")),dt=Q(require("fast-deep-equal")),E=Y($()),S=Y(K());function Q(t){return t&&t.__esModule?t:{default:t}}function X(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(X=function(r){return r?n:e})(t)}function Y(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=X(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var a=c?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}var G=(0,ht.default)({proto:!0}),lt=((w=lt||{})[w.CREATED=0]="CREATED",w[w.ATTACHED=1]="ATTACHED",w[w.DISABLE_WATCHES=2]="DISABLE_WATCHES",w[w.ENABLE_WATCHES=3]="ENABLE_WATCHES",w[w.CALL_WATCHES=4]="CALL_WATCHES",w),vt=0;function J(t,e){return t===e||t!=t&&e!=e}var R=function(){"use strict";function t(){this.observersItems=[],this.computedWatchDefId=vt++,this.computedList=[],this.watchList=[],this.watchFunctions=[];var n=this.computedWatchDefId,r=this.computedList,c=this.watchList,o=this.watchFunctions;this.observersItems.push({fields:"_computedWatchInit",observer:function(){var a=this,u=this.data._computedWatchInit;if(u===0){var p={computedUpdaters:[],computedRelatedPathValues:Array(r.length),watchCurVal:Array(c.length),watchDisabled:!1};this._computedWatchInfo||(this._computedWatchInfo={}),this._computedWatchInfo[n]=p,c.forEach(function(i,s){var v=i.map(function(h){var l=h.path,b=h.options,d=E.getDataOnPath(a.data,l);return b.deepCmp?G(d):d});p.watchCurVal[s]=v})}else if(u===1){var _=this._computedWatchInfo[n];r.forEach(function(i,s){var v,h=i[0],l=i[1],b=[],d=l(S.create(a.data,b));a.setData(((v={})[h]=S.unwrap(d),v)),_.computedRelatedPathValues[s]=b,_.computedUpdaters.push(function(){for(var j,D=_.computedRelatedPathValues[s],W=!1,I=0;I<D.length;I++){var x=D[I];if(x.kind==="keys"){var T=x.path,A=x.keys,f=Object.keys(E.getDataOnPath(a.data,T)).sort();if(f.length!==A.length){W=!0;break}for(var y=0;y<f.length;y+=1)if(f[y]!==A[y]){W=!0;break}}else{var m=x.path;if(!J(x.value,E.getDataOnPath(a.data,m))){W=!0;break}}}if(!W)return!1;var P=[],ot=l(S.create(a.data,P));return a.setData(((j={})[h]=S.unwrap(ot),j)),_.computedRelatedPathValues[s]=P,!0})})}else u===2?this._computedWatchInfo[n].watchDisabled=!0:u===3?this._computedWatchInfo[n].watchDisabled=!1:u===4&&o.forEach(function(i){return i.call(a)})}})}var e=t.prototype;return e.addComputed=function(n,r){if(this.computedList.push([n,r]),this.computedList.length===1){var c=this.computedWatchDefId;this.observersItems.push({fields:"**",observer:function(){var o,a=this;if(this._computedWatchInfo){var u=this._computedWatchInfo[c];if(u)do try{o=u.computedUpdaters.some(function(p){return p.call(a)})}catch(p){console.error(p.stack);break}while(o)}}})}},e.addWatch=function(n,r){var c=this.computedWatchDefId,o=E.parseMultiDataPaths(n),a=this.watchList.length;this.watchList.push(o),this.watchFunctions.push(function(){var u=this,p=o.map(function(_){var i=_.path;return E.getDataOnPath(u.data,i)});r.apply(this,p)}),this.observersItems.push({fields:n,observer:function(){var u=this;if(this._computedWatchInfo){var p=this._computedWatchInfo[c];if(p){var _=p.watchCurVal[a],i=o.map(function(l){var b=l.path,d=l.options;return{val:E.getDataOnPath(u.data,b),options:d}}),s=i.map(function(l){var b=l.val;return l.options.deepCmp?G(b):b});if(p.watchCurVal[a]=s,!p.watchDisabled){for(var v=!1,h=0;h<s.length;h++)if(o[h].options.deepCmp?!(0,dt.default)(_[h],s[h]):!J(_[h],s[h])){v=!0;break}v&&r.apply(this,i.map(function(l){return l.val}))}}}}})},t}(),yt=Behavior({lifetimes:{attached:function(){this.setData({_computedWatchInit:1})},created:function(){this.setData({_computedWatchInit:0})}},methods:{disableWatches:function(){this.setData({_computedWatchInit:2})},enableWatches:function(t){this.setData({_computedWatchInit:3}),t&&this.setData({_computedWatchInit:4})},triggerAllWatches:function(){this.setData({_computedWatchInit:4})}},definitionFilter:function(t){var e,n,r=t.computed,c=t.watch,o=new R;r&&Object.keys(r).forEach(function(u){var p=r[u];o.addComputed(u,p)}),c&&Object.keys(c).forEach(function(u){var p=c[u];o.addWatch(u,p)});var a=o.observersItems;((e=t.observers)&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e)!="object"&&(t.observers={}),Array.isArray(t.observers)?(n=t.observers).push.apply(n,[].concat(a)):a.forEach(function(u){var p=t.observers[u.fields];p?t.observers[u.fields]=function(){u.observer.call(this),p.call(this)}:t.observers[u.fields]=u.observer})}}),tt=function(t){if(!t._computedWatchInit){t._computedWatchInit=!0;var e=t.lifetime,n=t.setData;e("attached",function(){n({_computedWatchInit:1})}),e("created",function(){n({_computedWatchInit:0})})}};function bt(t,e,n,r,c){tt(t);var o=new R;return Object.keys(e).forEach(function(a){var u=e[a];o.addComputed(a,u)}),n&&Object.keys(n).forEach(function(a){var u=n[a];o.addComputed(a,u)}),r&&Object.keys(r).forEach(function(a){var u=r[a];o.addComputed(a,u)}),c&&Object.keys(c).forEach(function(a){var u=c[a];o.addComputed(a,u)}),o.observersItems.forEach(function(a){var u=a.fields,p=a.observer;t.observer(u,p)}),t.data}var et=function(t){return{disableWatches:function(){t.setData({_computedWatchInit:2})},enableWatches:function(e){t.setData({_computedWatchInit:3}),e&&t.setData({_computedWatchInit:4})},triggerAllWatches:function(){t.setData({_computedWatchInit:4})}}},mt=function(t,e,n){tt(t);var r=new R;return r.addWatch(e,n),r.observersItems.forEach(function(c){var o=c.fields,a=c.observer;t.observer(o,a)}),et(t.self)}});Object.defineProperty(exports,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(exports,{BehaviorWithComputed:function(){return wt},ComponentWithComputed:function(){return _t},DataTracerMode:function(){return Wt},behavior:function(){return k.behavior},computed:function(){return k.computed},getCurrentDataTracerMode:function(){return xt},setCurrentDataTracerMode:function(){return Pt},watch:function(){return k.watch}});var O,k=nt();function _t(t){return Array.isArray(t.behaviors)||(t.behaviors=[]),t.behaviors.unshift(k.behavior),Component(t)}function wt(t){return Array.isArray(t.behaviors)||(t.behaviors=[]),t.behaviors.unshift(k.behavior),Behavior(t)}var Wt=((O={})[O.Auto=0]="Auto",O[O.Proxy=1]="Proxy",O[O.DefineProperty=2]="DefineProperty",O),rt=0,xt=function(){return rt},Pt=function(t){rt=t};
